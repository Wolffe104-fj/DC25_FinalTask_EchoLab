# DC25_FinalTask_EchoLab

## Описание

Проект выполнен командой **Echo Lab** в рамках **DataCon 2025: Искусственный интеллект в разработке фармацевтических молекул.**

Задача, которую мы пытались решить этим проектом: сгенерировать с помощью ИИ новые молекулы, потенциально способные взаимодействовать с ключевыми мишенями, участвующими в патогенезе болезни Альцгеймера, открывая путь к более эффективным методам лечения.

Проект представляет собой комплексный пайплайн для:
1. Сбора данных о биоактивных соединениях из базы ChEMBL
2. Предварительной обработки и генерации молекулярных дескрипторов
3. Построения и оптимизации моделей машинного обучения для прогнозирования активности
4. Генерации новых молекул с помощью нейросети REINVENT
5. Фильтрации и оценки сгенерированных соединений

Проект ориентирован на 3 ключевые мишени:
- **DRD2** (Dopamine D2 receptor)
- **MAOA** (Monoamine oxidase A)
- **SERT** (Serotonin transporter)
При необходимости есть возможность легко изменить мишени в **TARGETS_CONFIG**

## Требования к системе

- Python 3+
- Google Colab (рекомендуется) или локальное окружение с GPU
- Учетная запись Google Drive для сохранения результатов
- ~10 ГБ свободного места на диске

## Установка зависимостей

Перед запуском необходимо установить все зависимости:
```bash
!pip install "networkx==2.3" "decorator==4.3.0" "numpy<1.24" mordred[full] rdkit-pypi
!pip install pandas requests matplotlib seaborn scikit-learn tqdm
!pip install optuna catboost shap meeko
```

Для генерации молекул требуется дополнительная установка REINVENT:
```bash
!pip uninstall -y torch torchvision torchaudio
!pip install --upgrade git+https://github.com/MolecularAI/REINVENT4.git@main
```

## Структура

Проект организован в виде последовательности этапов, каждый из которых сохраняет результаты в Google Drive:
```
DataCon2025/
├── all_csv/                # Все рабочие csv, сохранненые по этапам
│   ├── 01_raw_data/          # Исходные данные из ChEMBL
│   ├── 02_processed/         # Предобработанные данные
│   ├── 03_with_features/     # Данные с молекулярными дескрипторами
│   ├── 04_cleaned_features   # Очищенные признаки
│   ├── 05_pca_results/       # Результаты PCA
│   ├── 06_final_dataset/     # Финальные датасеты
│   └── 07_combined/          # Объединенный датасет
├── ML_Best/                # Лучшие модели и метрики
│   ├── best_model.pkl
│   ├── variance_threshold.pkl
│   └── shap_importance.csv
└── nn/                       # Генерация молекул
    ├── agent.toml            # Конфиг для REINVENT
    └── output/               # Результаты генерации
        ├── sampling.csv      # Сгенерированные молекулы
        ├── annotated_molecules.csv  # Аннотированные молекулы
        └── selected_hits.csv        # Отобранные хиты
```

## Использование

1. Последовательно запустите все ячейки в Google Colab
2. Монтируйте Google Drive при запросе
3. Результаты будут автоматически сохранены в указанные папки

Для повторного использования:
- Загрузите `best_model.pkl` и вспомогательные файлы
- Используйте функцию `predict_pvalue()` для новых молекул

## Контакты

По вопросам использования обращайтесь к автору проекта.
